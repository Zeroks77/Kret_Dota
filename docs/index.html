<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Kret&#39;s EU Dota League - Reports</title>
<link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap' rel='stylesheet'>
<style>
:root{--bg:#0b1020;--panel:#121832;--muted:#9aa3b2;--text:#eef1f7;--accent:#6da6ff;--chip:#1a2142;--border:rgba(255,255,255,.08)}
*{box-sizing:border-box}
body{margin:0;background:radial-gradient(1200px 600px at 10% -10%, #172045, transparent 60%), var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;height:100vh;display:flex}
.sidebar{width:360px;min-width:280px;max-width:420px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border-right:1px solid var(--border);padding:16px;display:flex;flex-direction:column;gap:12px}
.brand h1{font-size:20px;margin:0}
.sub{color:var(--muted);font-size:13px}
.filters{display:flex;flex-wrap:wrap;gap:6px}
.btn{padding:6px 10px;border:1px solid var(--border);border-radius:10px;background:#0e1533;color:var(--text);cursor:pointer;font-size:12px}
.btn.active{outline:2px solid rgba(109,166,255,.6)}
.search{width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.04);color:var(--text);outline:none}
.list{margin:0;padding:0;list-style:none;overflow:auto;border:1px solid var(--border);border-radius:12px;flex:1;background:rgba(255,255,255,.02)}
/* Treeview styles */
.tree .group{border-bottom:1px solid rgba(255,255,255,.06)}
.tree .group:last-child{border-bottom:none}
.tree .head{display:flex;align-items:center;gap:8px;padding:10px 12px;cursor:pointer;user-select:none}
.tree .head:hover{background:rgba(255,255,255,.06)}
.tree .caret{display:inline-block;transition:transform .15s ease;opacity:.8}
.tree .group[data-open="true"] .caret{transform:rotate(90deg)}
.tree .group > ul{margin:0;padding:0 0 6px 18px;list-style:none;display:none}
.tree .group[data-open="true"] > ul{display:block}
.item a{display:block;padding:8px 12px;color:var(--text);text-decoration:none;border-radius:8px;margin:2px 8px}
.item a:hover{background:rgba(255,255,255,.06)}
.item.active a{background:rgba(109,166,255,.18)}
.viewer{flex:1;display:flex;flex-direction:column}
.viewerbar{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border);background:rgba(255,255,255,.03)}
.viewerbar .title{font-weight:600}
.viewerbar .nav{display:flex;gap:8px}
.nav .btn{padding:6px 10px}
iframe{border:0;flex:1;width:100%}
a{color:var(--accent)}
</style>
</head>
<body>
  <aside class='sidebar'>
    <div class='brand'>
      <h1>Reports - Kret&#39;s EU Dota League</h1>
      <div class='sub'>Pick a run or filter by range.</div>
    </div>
  <!-- Filters removed; Dynamic view is available as a pinned list entry below -->
    <input id='q' class='search' type='text' placeholder='Search (date/range) ...'>
    <ul id='list' class='list tree'>
      <li class='group' data-open='true'>
        <div class='head' role='button' tabindex='0'><span class='caret'>▶</span><span>Alltime</span></div>
        <ul>
          <li class="item leaf" data-range="all-games" data-time="638921514347223757"><a href="./kret-s-eu-dota-league_all-games_latest.html">All games (latest)</a></li>
        </ul>
      </li>
      <li class='group' data-open='true'>
        <div class='head' role='button' tabindex='0'><span class='caret'>▶</span><span>Dynamic</span></div>
        <ul>
          <li class="item leaf" data-range="dynamic" data-time="9223372036854775807"><a href="./dynamic.html">Dynamic view (custom timeframe)</a></li>
        </ul>
      </li>
  <li class='group' data-open='true'>
        <div class='head' role='button' tabindex='0'><span class='caret'>▶</span><span>2025-08</span></div>
        <ul>
          <li class="item leaf" data-range="30-days" data-time="638921514431305181"><a href="./kret-s-eu-dota-league_30-days_2025-08-30_1150.html">2025-08-30 11:50 - 30 days</a></li>
        </ul>
      </li>
    </ul>
  </aside>

  <main class='viewer'>
    <div class='viewerbar'>
      <div class='title' id='viewerTitle'>-</div>
      <div class='nav'>
        <button class='btn' id='prevBtn' title='Previous (ArrowUp)'><- Previous</button>
        <button class='btn' id='nextBtn' title='Next (ArrowDown)'>Next -></button>
        <a class='btn' id='openNew' target='_blank' rel='noopener'>Open in new tab</a>
      </div>
    </div>
    <iframe id='frame' src='about:blank' loading='eager' referrerpolicy='no-referrer'></iframe>
  </main>

<script>
(function(){
  const list = document.getElementById('list');
  const groups = Array.from(list.querySelectorAll('.group'));
  const heads = Array.from(list.querySelectorAll('.group > .head'));
  const leaves = Array.from(list.querySelectorAll('.leaf'));
  const q = document.getElementById('q');
  const frame = document.getElementById('frame');
  const title = document.getElementById('viewerTitle');
  const openNew = document.getElementById('openNew');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  let selIndex = -1;

  function leafVisible(li){
    // visible if displayed, and not inside a collapsed group
    if (li.style.display === 'none') return false;
    const grp = li.closest('.group');
    if (grp && grp.getAttribute('data-open') !== 'true') return false;
    return true;
  }
  function vis(){ return leaves.filter(li => leafVisible(li)); }
  function txt(li){ const a=li.querySelector('a'); return a ? a.textContent.trim() : li.getAttribute('data-range'); }

  function apply(){
    const term = q.value.trim().toLowerCase(); let n=0;
    leaves.forEach(li=>{
      const t = txt(li).toLowerCase();
      const ok = (!term || t.includes(term));
      li.style.display = ok ? '' : 'none'; if (ok) n++;
    });
    // hide groups with no visible children
    groups.forEach(g=>{
      const hasVisible = Array.from(g.querySelectorAll('.leaf')).some(leaf=>leafVisible(leaf));
      g.style.display = hasVisible ? '' : 'none';
    });
    if (n===0){ selIndex=-1; frame.src='about:blank'; title.textContent='No results'; openNew.removeAttribute('href'); }
    else if (selIndex<0){ select(0); }
    sync();
  }
  function select(i){
    const v = vis(); if (!v.length) return;
    if (i<0) i=0; if (i>=v.length) i=v.length-1;
    leaves.forEach(li => li.classList.remove('active'));
    const li=v[i]; li.classList.add('active');
    const a=li.querySelector('a');
    if (a){ const href=a.getAttribute('href'); frame.src=href; title.textContent=a.textContent.trim(); openNew.setAttribute('href',href); history.replaceState(null,'','#file='+encodeURIComponent(href)); }
    selIndex=i; li.scrollIntoView({block:'nearest'}); sync();
  }
  function sync(){ const v=vis(); prevBtn.disabled = (selIndex<=0 || !v.length); nextBtn.disabled = (selIndex>=v.length-1 || !v.length); }

  // toggle groups
  heads.forEach(h=>{
    const grp = h.parentElement;
    function toggle(){ grp.setAttribute('data-open', grp.getAttribute('data-open')==='true' ? 'false' : 'true'); sync(); }
    h.addEventListener('click', toggle);
    h.addEventListener('keydown', ev=>{ if (ev.key==='Enter' || ev.key===' ') { ev.preventDefault(); toggle(); }});
  });

  // leaf click
  leaves.forEach(li=>li.addEventListener('click', e=>{e.preventDefault(); const v=vis(); const idx=v.indexOf(li); if (idx>=0) select(idx);}));
  q.addEventListener('input', apply);
  prevBtn.addEventListener('click', ()=> select(selIndex-1));
  nextBtn.addEventListener('click', ()=> select(selIndex+1));
  document.addEventListener('keydown', ev=>{ if (ev.key==='ArrowUp'){ev.preventDefault(); select(selIndex-1);} if (ev.key==='ArrowDown'){ev.preventDefault(); select(selIndex+1);} });

  function init(){
    const file = new URLSearchParams(location.hash.replace(/^#/, '')).get('file');
    if (file){
      const t=leaves.find(li => li.querySelector('a')?.getAttribute('href')===file);
      if (t){ const grp=t.closest('.group'); if (grp) grp.setAttribute('data-open','true'); const v=vis(); const idx=v.indexOf(t); if (idx>=0){ select(idx); return; } }
    }
    apply();
  }
  init();
})();
</script>
</body>
</html>
