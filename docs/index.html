<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Kret&#39;s EU Dota League - Reports</title>
<link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap' rel='stylesheet'>
<style>
:root{--bg:#0b1020;--panel:#121832;--muted:#9aa3b2;--text:#eef1f7;--accent:#6da6ff;--chip:#1a2142;--border:rgba(255,255,255,.08)}
*{box-sizing:border-box}
body{margin:0;background:radial-gradient(1200px 600px at 10% -10%, #172045, transparent 60%), var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;height:100vh;display:flex}
.sidebar{width:360px;min-width:280px;max-width:420px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border-right:1px solid var(--border);padding:16px;display:flex;flex-direction:column;gap:12px}
.brand h1{font-size:20px;margin:0}
.sub{color:var(--muted);font-size:13px}
.filters{display:flex;flex-wrap:wrap;gap:6px}
.btn{padding:6px 10px;border:1px solid var(--border);border-radius:10px;background:#0e1533;color:var(--text);cursor:pointer;font-size:12px}
.btn.active{outline:2px solid rgba(109,166,255,.6)}
.search{width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.04);color:var(--text);outline:none}
.list{margin:0;padding:0;list-style:none;overflow:auto;border:1px solid var(--border);border-radius:12px;flex:1;background:rgba(255,255,255,.02)}
.item a{display:block;padding:10px 12px;color:var(--text);text-decoration:none;border-bottom:1px solid rgba(255,255,255,.06)}
.item a:hover{background:rgba(255,255,255,.06)}
.item.active a{background:rgba(109,166,255,.18)}
.viewer{flex:1;display:flex;flex-direction:column}
.viewerbar{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border);background:rgba(255,255,255,.03)}
.viewerbar .title{font-weight:600}
.viewerbar .nav{display:flex;gap:8px}
.nav .btn{padding:6px 10px}
iframe{border:0;flex:1;width:100%}
a{color:var(--accent)}
</style>
</head>
<body>
  <aside class='sidebar'>
    <div class='brand'>
      <h1>Reports - Kret&#39;s EU Dota League</h1>
      <div class='sub'>Pick a run or filter by range.</div>
    </div>
    <div class='filters'>
      <button class='btn' data-f='all'>All entries</button>
      <button class='btn' data-f='30-days'>30 days</button>
      <button class='btn' data-f='60-days'>60 days</button>
      <button class='btn' data-f='120-days'>120 days</button>
      <button class='btn' data-f='last-patch'>Last patch</button>
      <button class='btn' data-f='all-games'>All games</button>
    </div>
    <input id='q' class='search' type='text' placeholder='Search (date/range) ...'>
    <ul id='list' class='list'>
<li class="item" data-range="2025-08-30" data-time="638921226972624780"><a href="./kret-s-eu-dota-league_30-days_2025-08-30_0351.html">2025-08-30 03:51 - 2025-08-30</a></li>
    </ul>
  </aside>

  <main class='viewer'>
    <div class='viewerbar'>
      <div class='title' id='viewerTitle'>-</div>
      <div class='nav'>
        <button class='btn' id='prevBtn' title='Previous (ArrowUp)'><- Previous</button>
        <button class='btn' id='nextBtn' title='Next (ArrowDown)'>Next -></button>
        <a class='btn' id='openNew' target='_blank' rel='noopener'>Open in new tab</a>
      </div>
    </div>
    <iframe id='frame' src='about:blank' loading='eager' referrerpolicy='no-referrer'></iframe>
  </main>

<script>
(function(){
  const list = document.getElementById('list');
  const items = Array.from(list.querySelectorAll('.item'));
  const q = document.getElementById('q');
  const btns = Array.from(document.querySelectorAll('.filters .btn'));
  const frame = document.getElementById('frame');
  const title = document.getElementById('viewerTitle');
  const openNew = document.getElementById('openNew');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');

  let filter = 'all';
  let selIndex = -1;

  function visibleItems(){ return items.filter(li => li.style.display !== 'none'); }
  function humanize(li){
    const a = li.querySelector('a');
    return a ? a.textContent.trim() : li.getAttribute('data-range');
  }

  function applyFilter(){
    const term = q.value.trim().toLowerCase();
    let visible = 0;
    items.forEach(li=>{
      const rg = li.getAttribute('data-range');
      const text = humanize(li).toLowerCase();
      const okRange = (filter === 'all' || rg === filter);
      const okText  = (!term || text.includes(term));
      li.style.display = (okRange && okText) ? '' : 'none';
      if (li.style.display !== 'none') visible++;
    });
    if (visible === 0){
      selIndex = -1; frame.src='about:blank'; title.textContent='No results'; openNew.removeAttribute('href');
    } else if (selIndex < 0){
      selectIndex(0);
    }
    syncButtons();
  }

  function selectIndex(i){
    const vis = visibleItems(); if (!vis.length) return;
    if (i < 0) i = 0; if (i >= vis.length) i = vis.length - 1;
    vis.forEach(li => li.classList.remove('active'));
    const li = vis[i]; li.classList.add('active');
    const a = li.querySelector('a');
    if (a){
      const href = a.getAttribute('href');
      frame.src = href;
      title.textContent = a.textContent.trim();
      openNew.setAttribute('href', href);
      history.replaceState(null,'','#file='+encodeURIComponent(href));
    }
    selIndex = i;
    li.scrollIntoView({block:'nearest'});
    syncButtons();
  }

  function syncButtons(){
    const vis = visibleItems();
    prevBtn.disabled = (selIndex <= 0 || vis.length === 0);
    nextBtn.disabled = (selIndex >= vis.length - 1 || vis.length === 0);
  }

  items.forEach(li=>{
    li.addEventListener('click', (e)=>{
      e.preventDefault();
      const vis = visibleItems();
      const idx = vis.indexOf(li);
      if (idx >= 0) selectIndex(idx);
    });
  });

  btns.forEach(b=>{
    b.addEventListener('click', ()=>{
      btns.forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      filter = b.getAttribute('data-f');
      applyFilter();
    });
  });

  q.addEventListener('input', applyFilter);
  prevBtn.addEventListener('click', ()=> selectIndex(selIndex - 1));
  nextBtn.addEventListener('click', ()=> selectIndex(selIndex + 1));
  document.addEventListener('keydown', (ev)=>{
    if (ev.key === 'ArrowUp'){ ev.preventDefault(); selectIndex(selIndex - 1); }
    if (ev.key === 'ArrowDown'){ ev.preventDefault(); selectIndex(selIndex + 1); }
  });

  // Init
  function initSelect(){
    const params = new URLSearchParams(location.search);
    const rangeQ = params.get('range');
    const hash = new URLSearchParams(location.hash.replace(/^#/, ''));
    const file = hash.get('file');

    if (rangeQ){
      const btn = btns.find(b=>b.getAttribute('data-f') === rangeQ);
      if (btn) { btn.click(); }
    } else {
      btns[0].classList.add('active'); // All entries
    }

    if (file){
      const target = items.find(li => li.querySelector('a')?.getAttribute('href') === file);
      if (target && target.style.display !== 'none'){
        const vis = visibleItems(); const idx = vis.indexOf(target);
        if (idx >= 0) { selectIndex(idx); return; }
      }
    }
    applyFilter();
  }

  initSelect();
})();
</script>
</body>
</html>
